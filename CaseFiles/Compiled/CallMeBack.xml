<definitions>
    <caseFileItemDefinition name="output" definitionType="http://www.omg.org/spec/CMMN/DefinitionType/Unspecified" id="output.cfid">
        <property name="message" type="http://www.omg.org/spec/CMMN/PropertyType/string"/>
        <property name="success" type="http://www.omg.org/spec/CMMN/PropertyType/boolean"/>
    </caseFileItemDefinition>
    <caseFileItemDefinition name="task" definitionType="http://www.omg.org/spec/CMMN/DefinitionType/Unspecified" id="task.cfid"/>
    <case id="CallMeBack.case" name="CallMeBack" expressionLanguage="spel">
        <caseFileModel>
            <caseFileItem id="_xgszO_3" name="output" multiplicity="ExactlyOne" definitionRef="output.cfid"/>
            <caseFileItem id="_xgszO_6" name="task" multiplicity="ExactlyOne" definitionRef="task.cfid"/>
        </caseFileModel>
        <casePlanModel id="cm__xgszO_0" name="CallMeBack" autoComplete="true">
            <planItem id="pi_pt__xgszO_0" name="CallBack to MockServer" definitionRef="pt__xgszO_0"/>
            <planItem id="pi_ue__xgszO_0" name="NotifyDone" definitionRef="ue__xgszO_0"/>
            <processTask id="pt__xgszO_0" name="CallBack to MockServer" isBlocking="true" processRef="CallBack.process">
                <inputs id="_xgszO_15" name="task" bindingRef="_xgszO_6"/>
                <inputs id="_xgszO_17" name="caseId"/>
                <outputs id="_xgszO_18" name="output" bindingRef="_xgszO_3"/>
                <parameterMapping id="_xgszO_2" sourceRef="_xgszO_15" targetRef="_rmBM_task"/>
                <parameterMapping id="_xgszO_8" sourceRef="_xgszO_17" targetRef="_0Dqq_caseId">
                    <transformation id="_xgszO_16">
                        <body>
                            <![CDATA[case.id]]>
                        </body>
                    </transformation>
                </parameterMapping>
                <parameterMapping id="_xgszO_13" sourceRef="_FU0v_responseCode" targetRef="_xgszO_18"/>
            </processTask>
            <userEvent id="ue__xgszO_0" name="NotifyDone"/>
        </casePlanModel>
        <input id="_xgszO_5" name="task" bindingRef="_xgszO_6"/>
    </case>
    <process name="CallBack" implementationType="http://www.omg.org/spec/CMMN/ProcessType/Unspecified" id="CallBack.process">
        <input id="_rmBM_task" name="operation"/>
        <input id="_0Dqq_caseId" name="caseId"/>
        <output id="_FU0v_responseCode" name="output"/>
        <extensionElements>
            <cafienne:implementation xmlns:cafienne="org.cafienne" class="org.cafienne.processtask.implementation.http.HTTPCallDefinition" async="true">
                <url>${T(java.lang.System).getenv("TestBaseUrl")}/cmmn-wrapper?HandlerName=TestCallBack</url>
                <method>POST</method>
                <post-content>
       {
         "Task": "${operation}",
         "CaseInstanceId": "${caseId}"
       }
    </post-content>
                <http-headers>
                    <http-header name="Accept">*/*</http-header>
                    <http-header name="Content-Type">application/json</http-header>
                </http-headers>
                <success>
                    <parameterMapping sourceRef="responsePayload" targetRef="output">
                        <transformation language="spel">
                            <body>
            map("success", true, "message", responsePayload)
          </body>
                        </transformation>
                    </parameterMapping>
                </success>
                <failure>
                    <parameterMapping sourceRef="responsePayload" targetRef="output">
                        <transformation language="spel">
                            <body>
            map("success", false, "message", responsePayload)
          </body>
                        </transformation>
                    </parameterMapping>
                </failure>
            </cafienne:implementation>
        </extensionElements>
    </process>
    <CMMNDI>
        <CMMNDiagram>
            <CMMNShape cmmnElementRef="cm__xgszO_0">
                <Bounds x="20" y="20" width="800" height="500"/>
            </CMMNShape>
            <CMMNShape cmmnElementRef="pi_pt__xgszO_0">
                <Bounds x="190" y="130" width="140" height="80"/>
            </CMMNShape>
            <CMMNShape cmmnElementRef="pi_ue__xgszO_0">
                <Bounds x="490" y="200" width="32" height="32"/>
            </CMMNShape>
        </CMMNDiagram>
    </CMMNDI>
</definitions>